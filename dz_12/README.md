# Домашняя задание 12. Мусаев Умахан Рашидович.

## Условие задания:
До 8 баллов
Реализовать для родительского и дочернего процесса двухстороннюю связь с использованием только одного неименованного канала (pipe) и циклической организацией обмена посредством семафора Unix System V. При этом канал должен быть постоянно открытым. Интервал для обмена должен быть равен одной секунде. Обмен должен завершаться после поочередной передачи в каждую сторону по десять сообщений. По завершении обмена обеспечить корректное закрытие канала и удаление семафора.
Опционально +2 балла
Вместо десяти обменов организовать поочередный обмен, завершающийся посылкой сигнала прерывания с клавиатуры родительскому или дочернему процессу. При этом оба процесса должны корректно завершить работу с закрытием канала и удалением семафора.


## Программа реализована на 10 баллов.
## Реализованная функциональность

1. **Двусторонний обмен данными** через один неименованный канал (pipe)
2. **Синхронизация доступа** к каналу с помощью семафоров System V
3. **Циклический обмен сообщениями** между процессами с интервалом 1 секунда
4. **Корректное завершение по сигналу прерывания** (Ctrl+C)
5. **Корректное освобождение ресурсов** (закрытие pipe, удаление семафоров)

## Компиляция и запуск
1. `g++ -o pepe pepe.cpp`
2. `./pepe`

## Завершение работы программы
3. Нажмите `Ctrl+C`


## Алгоритм работы программы

1. **Инициализация ресурсов:**
   - Создание неименованного канала (pipe)
   - Создание набора из двух семафоров System V
   - Установка обработчика сигнала SIGINT (Ctrl+C)

2. **Создание дочернего процесса** с помощью `fork()`

3. **Цикл обмена сообщениями:**
   - **Родительский процесс:**
     1. Ожидает доступа к каналу (wait на семафоре PARENT_SEM)
     2. Отправляет сообщение через pipe
     3. Сигнализирует дочернему процессу (signal на семафоре CHILD_SEM)
     4. Ожидает ответа (wait на семафоре PARENT_SEM)
     5. Читает ответ из pipe
   - **Дочерний процесс:**
     1. Ожидает сообщения (wait на семафоре CHILD_SEM)
     2. Читает сообщение из pipe
     3. Отправляет ответ через pipe
     4. Сигнализирует родительскому процессу (signal на семафоре PARENT_SEM)

4. **Завершение работы:**
   - При получении сигнала SIGINT оба процесса завершают работу
   - Родительский процесс закрывает pipe и удаляет семафоры
   - Дочерний процесс закрывает pipe

## Особенности реализации

### Использование одного канала для двусторонней связи

В программе для организации двусторонней связи используется один канал, что требует тщательной синхронизации доступа к нему. Для этого применяются семафоры System V, которые обеспечивают поочередный доступ процессов к каналу.

### Семафоры System V

Набор из двух семафоров обеспечивает синхронизацию:
- `PARENT_SEM` - контролирует право родительского процесса на доступ к каналу
- `CHILD_SEM` - контролирует право дочернего процесса на доступ к каналу

Начальные значения: `PARENT_SEM = 1`, `CHILD_SEM = 0`.

### Обработка сигнала прерывания

При получении сигнала SIGINT (Ctrl+C) устанавливается флаг `shouldTerminate`, что приводит к корректному завершению циклов обмена и освобождению ресурсов.


# Примеры работы программы:
![image](https://github.com/user-attachments/assets/11d57ab0-4c45-48d0-8e2e-755eeededbd7)

![image](https://github.com/user-attachments/assets/0f585925-db77-4e1b-a101-3c2b64b70687)

